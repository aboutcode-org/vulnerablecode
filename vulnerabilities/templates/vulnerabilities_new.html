{% extends 'base_new.html' %}

{% block title %}
VCIO -- vulnerability search
{% endblock %}

{% block content %}

{% include 'navbar01.html' %}

<section class="section01">

    <div class="columns">
        <div class="column is-four-fifths">
            <div class="tags has-addons">
                <span class="tag is-medium is-light is-search-label-left">Search vulnerabilities by vuln_id: </span>
                <span class="tag is-medium is-white is-search-label-right">"{{vuln_id}}"</span>
            </div>
        </div>
        <div class="column" style="text-align: right;">
            <a class="button is-link" href="/index_new">Return to search</a>
        </div>
    </div>
    <div class="columns">
        <div class="column" style="text-align: center; padding: 0px;">
            Total records: {{ result_size }}
        </div>
    </div>

    <div class="is-field is-horizontal" style="text-align: center;">
        <span class="step-links">
            {% if vulnerabilities.has_previous %}
            <a class="button paging" href="?vuln_id={{ vuln_id }}&page=1">&laquo; first</a>
            <a class="button paging" href="?vuln_id={{ vuln_id }}&page={{ vulnerabilities.previous_page_number }}">previous</a>
            {% else %}
            <button class="button" title="disabled" disabled>&laquo; first</button>
            <button class="button" title="disabled" disabled>previous</button>
            {% endif %}

            <span class="current02">
                (page {{ vulnerabilities.number }} of {{ vulnerabilities.paginator.num_pages }})
            </span>

            {% if vulnerabilities.has_next %}
            <a class="button paging" href="?vuln_id={{ vuln_id }}&page={{ vulnerabilities.next_page_number }}">next</a>
            <a class="button paging" href="?vuln_id={{ vuln_id }}&page={{ vulnerabilities.paginator.num_pages }}">last &raquo;</a>
            {% else %}
            <button class="button" title="disabled" disabled>next</button>
            <button class="button" title="disabled" disabled>last &raquo;</button>
            {% endif %}
        </span>
    </div>

</section>

{% if vulnerabilities %}
<section class="section01">
    <div class="content">
        <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth">
            <tr>
                <th><span class="has-tooltip-multiline has-tooltip-black has-tooltip-arrow has-tooltip-text-left" data-tooltip="Tooltip coming soon!">Vulnerability ID</span></th>
                <th style="width: 225px;"><span class="has-tooltip-multiline has-tooltip-black has-tooltip-arrow has-tooltip-text-left" data-tooltip="Tooltip coming soon!">Affected packages</span></th>
                <th style="width: 225px;"><span class="has-tooltip-multiline has-tooltip-black has-tooltip-arrow has-tooltip-text-left" data-tooltip="Tooltip coming soon!">Fixed packages</span></th>
            </tr>
            {% for vulnerability in vulnerabilities %}
            <tr>
                <td style="word-break: break-all;">
                    {{vulnerability.vulnerability_id}}
                    <span style="font-size: 13px;">
                        (
                        <a href="{% url 'vulnerability_view' vulnerability.pk %}" target="_blank">old HTML</a>
                        |
                        <a href="{% url 'vulnerability_view_new' vulnerability.pk %}" target="_blank">new HTML</a>
                        )
                    </span>
                </td>
                <td>{{vulnerability.vulnerable_package_count}}</td>
                <td>{{vulnerability.patched_package_count}}</td>
            </tr>
            {% endfor %}
        </table>
    </div>

    <div style="height: 50px;"></div>

    <div class="is-field is-horizontal" style="text-align: center;">
        <span class="step-links">
            {% if vulnerabilities.has_previous %}
            <a class="button paging" href="?vuln_id={{ vuln_id }}&page=1">&laquo; first</a>
            <a class="button paging" href="?vuln_id={{ vuln_id }}&page={{ vulnerabilities.previous_page_number }}">previous</a>
            {% else %}
            <button class="button" title="disabled" disabled>&laquo; first</button>
            <button class="button" title="disabled" disabled>previous</button>
            {% endif %}

            <span class="current02">
                (page {{ vulnerabilities.number }} of {{ vulnerabilities.paginator.num_pages }})
            </span>

            {% if vulnerabilities.has_next %}
            <a class="button paging" href="?vuln_id={{ vuln_id }}&page={{ vulnerabilities.next_page_number }}">next</a>
            <a class="button paging" href="?vuln_id={{ vuln_id }}&page={{ vulnerabilities.paginator.num_pages }}">last &raquo;</a>
            {% else %}
            <button class="button" title="disabled" disabled>next</button>
            <button class="button" title="disabled" disabled>last &raquo;</button>
            {% endif %}
        </span>
    </div>

</section>

{% endif %}

{% endblock %}